{% extends 'base.html' %}
{% load crispy_forms_tags %}

{% block content %}
{% if messages %}
    {% for message in messages %}
    <div{% if message.tags %} class="alert {{ message.tags }}"{% endif %}>
      <strong>{% if message.level == DEFAULT_MESSAGE_LEVELS.SUCCESS %}success!{% endif %}</strong> {{ message }}
    </div>
    {% endfor %}
    <hr>
{% endif %}
<!--<form method="POST" action="">{% csrf_token %}-->
    <!--{{ f }}-->
    <!--<input type="submit" class="btn btn-success" value="send" />-->
<!--</form>-->
<div class="row">
    <div class="col-md-6">
        {% crispy form %}
    </div>
    <div class="col-md-6 hidden-xs">
        <div class="panel panel-success">
          <div class="panel-heading">
            <h3 class="panel-title text-center">Rules</h3>
          </div>
          <div class="panel-body">
              <ul>
                  <li>5 recommendations per day allowed</li>
                  <li>can't insert titles already rated</li>
                  <li>if recommended title will is rated it will be shown</li>
                  <li></li>
              </ul>
          </div>
        </div>
    </div>
</div>
<hr>
<div class="row">
    <div class="col-md-8 col-md-offset-2">
<h5 class="text-center">Progress bar for today's recommendations limit</h5>
<div class="progress">
  <div class="progress-bar progress-bar-{% if todays_count == 5 %}danger{% elif todays_count == 4 %}warning{% else %}info{% endif %}" role="progressbar" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100" style="width: {{ count.today2 }}0%">
    <span class="sr-only"></span>{{ count.today }} / 5
  </div>
    </div>
        </div>
</div>
<hr>
{% if obj_list %}
<div class="row">
    <div class="col-md-6 col-md-offset-3">
        <div class="alert alert-warning text-center" role="alert">{{ obj_list|length }} recommendation{{ obj_list|pluralize }} found</div>
    </div>
</div>
<table class="table table-hover table-bordered table-condensed">
    <thead>
        <tr>
            <th class="text-center"></th>
            <th class="text-center">title</th>
            <th class="text-center">date</th>
            {% if request.user.is_staff %}
            <th class="text-center">nick</th>
            <th class="text-center">note</th>
            {% endif %}
        </tr>
    </thead>
    <tbody>
        {% for obj in obj_list %}
        {{ obj.is_rated }}
        <tr class="{% if obj.is_rated %}recommended_is_rated{% endif %}">
            <th scope="row" class="col-md-1 text-center">{{ forloop.counter }}</th>
            <td class="" style="padding-left: 20px"><a href="http://www.imdb.com/title/{{ obj.const }}/" target="_blank">{{ obj.name }} </a>({{ obj.year }})</td>
            <td class="">{{ obj.date }}</td>
            {% if obj.is_rated %}<td class="">rated</td>{% endif %}
            {% if request.user.is_staff %}
            <td class="">{{ obj.nick }}</td>
            <td class="">{{ obj.note }}</td>
            {% endif %}
        </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
<div class="row">
    <div class="col-md-6 col-md-offset-3">
        <div class="alert alert-warning text-center" role="alert">No recommendations found</div>
    </div>
</div>
{% endif %}

{% endblock %}