{% extends 'base.html' %}
{% load static %}
{#{% block title %}{{ page_title }}{% endblock %}#}

{% block breadcrumb %}
    <div class="ui breadcrumb">
        <a class="section" href="{% url 'home' %}">Home</a>
        <i class="right angle icon divider"></i>
        <a class="section" href="{% url 'user-list' %}">Users</a>
        <i class="right angle icon divider"></i>
        <a class="section active" href="{% url 'user-detail' user.username %}">{{ user.username }}</a>
    </div>
{% endblock %}

{% block content %}
{#<div class="ui four cards">#}
{#  <div class="card">#}
{#    <div class="small image">#}
{#      <img src="{% static 'img/w185_h278_bestv2.jpg' %}">#}
{#    </div>#}
{#    <div class="extra">#}
{#      Rating:#}
{#      <div class="ui star rating" data-rating="4"></div>#}
{#    </div>#}
{#  </div>#}
{#</div>#}
{#<div class="four ui buttons">#}
{#  <a href="" class="ui button active">Overview</a>#}
{#  <a href="" class="ui button">Lists</a>#}
{#  <a href="" class="ui button">Charts</a>#}
{#    {% if is_other_user %}#}
{#        <a href="" class="ui button">Compared with you</a>#}
{#    {% endif %}#}
{#</div>#}
    <div class="ui divider hidden"></div>
    <div class="ui centered grid">
{#        <div class="eight wide mobile four wide computer four wide tablet column">#}
{#        <div class="column">#}
            <div class="ui card">
              <div class="image">
                <img src="{% static 'img/stevie.jpg' %}">
              </div>
              <div class="content">
                <a class="header">{{ user.username }}</a>
                <div class="meta">
                  <span class="date">Member since {{ user.date_joined|date:"M d, Y" }}</span>
                </div>
                  {% if user.tagline %}
                    <div class="description">
                      {{ user.tagline }}
                    </div>
                  {% endif %}
              </div>
              <div class="extra content">
{#                <a>#}
                  <i class="user icon"></i>
                  Follows {{ total_followed }} people
{#                </a>#}
              </div>
                {% if already_follows %}
                  <div class="ui bottom attached  small follow toggle button{% if already_follows %} active{% endif %}" data-pk="{{ user.pk }}">{% if already_follows %}Followed{% else %}Follow{% endif %}</div>
                {% endif %}
            </div>
{#        </div>#}
{#        <div class="eight wide mobile twelve wide computer twelve wide tablet centered column">#}

{#        </div>#}
    </div>

{#    todo big image from selected movie#}

    <div class="ui pointing secondary menu user-menu">
        <a class="item active" data-tab="first">Overview</a>
        <a class="item" data-tab="second">Lists</a>
        <a class="item" data-tab="third">Charts</a>
        {% if is_other_user %}
            <a class="item" data-tab="fourth">Compared with you</a>
        {% endif %}
    </div>

    <div class="ui tab segment active" data-tab="first">
        <div class="ui statistics">
          <div class="statistic">
            <div class="value">
              {{ user.total_ratings }}
            </div>
            <div class="label">
              Ratings
            </div>
          </div>
          <div class="statistic">
            <div class="value">
              {{ user.total_movies }}
            </div>
            <div class="label">
              Movies seen
            </div>
          </div>
          <div class="statistic">
            <div class="value">
              {{ user.total_series }}
            </div>
            <div class="label">
              Tv-shows seen
            </div>
          </div>
          <div class="statistic">
            <div class="value">
              {{ total_followers }}
            </div>
            <div class="label">
              Followers
            </div>
          </div>
        </div>
    </div>

    <div class="ui tab segment" data-tab="second">
{#        <h3 class="ui header"></h3><img class="ui wireframe image" src="/images/wireframe/paragraph.png"><img class="ui wireframe image" src="/images/wireframe/paragraph.png">#}
    </div>
    <div class="ui tab segment" data-tab="third">
{#        <h3 class="ui header"></h3><img class="ui wireframe image" src="/images/wireframe/paragraph.png"><img class="ui wireframe image" src="/images/wireframe/paragraph.png">#}
    </div>
    {% if is_other_user %}
        <div class="ui tab segment" data-tab="fourth">
            <div class="ui segment">
              <a class="ui teal ribbon label">Lower</a>
                <span>{{ user.username }} rated lower</span>
                <div class="ui list">
                    {% for title in comparision.titles_user_rate_lower %}
                        {% include 'titles/title_small.html' with title=title rate=title.user_rate rate2=title.request_user_rate %}
                    {% endfor %}
                    {% if not comparision.titles_user_rate_lower %}
                        <p>Nothing found</p>
                    {% endif %}
                </div>
            </div>
            <div class="ui segment">
              <a class="ui teal ribbon label">Higher</a>
                <span>{{ user.username }} rated higher</span>
                <div class="ui list">
                    {% for title in comparision.titles_user_rate_higher %}
                        {% include 'titles/title_small.html' with title=title rate=title.user_rate rate2=title.request_user_rate %}
                    {% endfor %}
                    {% if not comparision.titles_user_rate_higher %}
                        <p>Nothing found</p>
                    {% endif %}
                </div>
            </div>
            <div class="ui segment">
              <a class="ui teal ribbon label">The same</a>
                <span>{{ user.username }} rated the same</span>
                <div class="ui list">
                    {% for title in comparision.titles_rated_the_same %}
                        {% include 'titles/title_small.html' with title=title rate=title.user_rate rate2=title.request_user_rate %}
                    {% endfor %}
                    {% if not comparision.titles_rated_the_same %}
                        <p>Nothing found</p>
                    {% endif %}
                </div>
            </div>
        </div>
    {% endif %}
    <div class="ui segment">
      <a class="ui blue ribbon label">Activity</a>
        <span>{{ user.username }}'s latest ratings</span>
        <div class="ui list">
            {% for rating in rating_list %}
                {% include 'titles/title_small.html' with title=rating.title rate_date=rating.rate_date rate=rating.rate %}
            {% endfor %}
            {% if not rating_list %}
                <p>No ratings found</p>
            {% endif %}
        </div>
    </div>

    <div class="ui segment">
      <a class="ui blue ribbon label">Feed</a>
        <span>Latest activity of {{ user.username }}'s followed users</span>
        <div class="ui list">
            {% for rating in feed %}
              <div class="item">
                <img class="ui avatar image" src="{% static 'img/stevie.jpg' %}">
                <div class="content">
                  <span>{{ rating.rate_date }}</span>
                    <div class="description"><a href="{{ rating.user.get_absolute_url }}">{{ rating.user.username }}</a> rated <a href="{{ rating.title.get_absolute_url }}"><b>{{ rating.title.name }}</b></a> {{ rating.rate }}<i class="icon star green"></i></div>
                </div>
              </div>
            {% endfor %}
            {% if not feed %}
                <p>No activity found</p>
            {% endif %}
        </div>
    </div>

{#<div class="row lower">#}
{#	<div class="col-md-12">#}
{#		<div class="page-header text-center">#}
{#			<span class="lead">{{ object.username }}</span>#}
{#			{% if is_owner %}#}
{#			<a href="{{ object.edit_url }}">#}
{#                <button id="editSettings" type="button" class="btn btn-xs btn-success"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span> edit</button>#}
{#            </a>#}
{#        	{% endif %}#}
{#			{% if is_other_user %}#}
{#                {% include 'includes/actions/follow.html' with user_pk=object.pk condition=already_follows %}#}
{#			{% endif %}#}
{#		</div>#}
{#	</div>#}
{#</div>#}
{##}
{#<img id="avatar" class="img-responsive img-thumbnail center-block"#}
{#	 src="{% if object.picture %}{{ object.picture.url }}{% else %}{% static 'img/placeholderavatar.png' %}{% endif %}"#}
{#	 alt="...">#}
{##}
{#<div class="row text-center">#}
{#	<br>#}
{#	<div class="col-md-12">#}
{#		<a href="{{ object.watchlist_url }}" class="btn btn-sm btn-default">#}
{#			<span class="glyphicon glyphicon-list" aria-hidden="true"></span> watchlist#}
{#		</a>#}
{#		<a href="{{ object.favourite_url }}" class="btn btn-sm btn-default">#}
{#			<span class="glyphicon glyphicon-heart-empty" aria-hidden="true"></span> favourites#}
{#		</a>#}
{#		<a href="{{ object.recommend_url }}" class="btn btn-sm btn-default">#}
{#			<span class="glyphicon glyphicon-hand-right" aria-hidden="true"></span> recommend#}
{#		</a>#}
{#	</div>#}
{#</div>#}
{##}
{#{% if is_owner %}#}
{#<div class="row text-center">#}
{#	<br>#}
{#	<div class="col-md-12">#}
{#		{% if user.imdb_id or user.csv_ratings %}#}
{#		<div class="btn-group text-center">#}
{#			<form method="post" name="update_titles_form">{% csrf_token %}#}
{#				{% if user.imdb_id %}#}
{#					<button class="btn btn-xs btn-primary" type="submit" name="update_rss" value="update_rss">update ratings</button>#}
{##}
{#					<button class="btn btn-xs btn-primary" type="submit" name="update_watchlist" value="update_watchlist">update watchlist</button>#}
{#				{% endif %}#}
{#				{% if user.csv_ratings %}#}
{#					<button class="btn btn-xs btn-primary" type="submit" name="update_csv" value="update_csv">update csv</button>#}
{#				{% endif %}#}
{#			</form>#}
{#		</div>#}
{#		{% endif %}#}
{#	</div>#}
{#</div>#}
{#{% endif %}#}
{##}
{#<br>#}
{#<div class="row">#}
{#	<div class="col-md-8 col-md-offset-2">#}
{#		{% if not user_ratings.last_seen and is_owner %}#}
{#		<div class="text-center">#}
{#			<div class="alert alert-success alert-resize" role="alert">#}
{#				<p>You have no ratings yet.</p>#}
{#				<p><a href="{% url 'title-list' %}">Explore</a> titles or go ahead and <a href="{% url 'user-edit' user.username %}">edit</a> your profile to sync your account with IMDb.</p>#}
{#			</div>#}
{#		</div>#}
{#		{% endif %}#}
{#		<div class="panel panel-success">#}
{#			<div class="panel-heading text-center">Most Recently Rated</div>#}
{#			<div class="panel-body">#}
{#				{% if user_ratings.last_seen %}#}
{#				<div class="row">#}
{#					{% for entry in user_ratings.last_seen %}#}
{#						{% include 'titles/titles_in_a_row.html' with title=entry.title owner=is_owner rate=entry.rate req_user_rate=entry.req_user_curr_rating %}#}
{#					{% endfor %}#}
{#				</div>#}
{#				<hr>#}
{#				{% endif %}#}
{#				See all <a href="{{ object.ratings_url }}">{{ object.count_titles }} titles</a>#}
{#				or <a href="{{ object.all_ratings_url }}">{{ object.count_ratings }} ratings</a>#}
{#				<hr class="visible-sm visible-xs">#}
{#				<form id="import_form" method="post" enctype="multipart/form-data" action="{% url 'import-ratings' object.username %}" style="display:none">{% csrf_token %}#}
{#					<input id="import" name="csv_ratings" type="file" accept=".csv" />#}
{#				</form>#}
{##}
{#				<div style="display:inline;float: right;">#}
{#					{% if is_owner %}#}
{#						<form id="clear_ratings_form" method="post" action="{{ request.user.get_absolute_url }}" style="display:inline;margin-right:10px">{% csrf_token %}#}
{#							<input id="confirm-nick" name="confirm-nick" hidden>#}
{#							<button id="clear_ratings" type="submit" class="btn btn-xs btn-success" data-toggle="tooltip" title="You cannot revert this operation. You will lose all of you ratings if you haven't exported them first.">clear my ratings</button>#}
{#						</form>#}
{#						<a id="import_ratings" href="{% url 'import-ratings' object.username %}" style="margin-right:10px" data-toggle="tooltip" title="You can add ratings from exported file."><button class="btn btn-xs btn-success">import</button></a>#}
{#					{% endif %}#}
{#					<a href="{% url 'export-ratings' object.username %}" data-toggle="tooltip" title="You can export all of your ratings as a form of backup. If you will lose some of your ratings, you will be able to import them." target="_blank"><button class="btn btn-xs btn-success">export</button></a>#}
{#				</div>#}
{#			</div>#}
{#		</div>#}
{#	</div>#}
{#</div>#}
{#{% if user_ratings.common_with_req_user %}#}
{#<div class="row">#}
{#	<div class="col-md-8 col-md-offset-2">#}
{#		<div class="panel panel-success">#}
{#			<div class="panel-heading text-center">Compared to you</div>#}
{#			<div class="panel-body">#}
{#				{% if user_ratings.common_with_req_user.not_rated_by_req_user %}#}
{#				<div>#}
{#					<div class="row">#}
{#						<p class="text-center lead">Titles {{ object.username }} liked that you haven't rated</p>#}
{#						{% for title in user_ratings.common_with_req_user.not_rated_by_req_user %}#}
{#							{% include 'titles/titles_in_a_row.html' with title=title owner=is_owner rate=title.user_rate %}#}
{#						{% endfor %}#}
{#					</div>#}
{#					See all <a href="{{ object.ratings_exclude }}">{{ user_ratings.common_with_req_user.not_rated_by_req_user_count }} titles</a> you haven't rated#}
{#				</div>#}
{#				<hr>#}
{#				{% endif %}#}
{#				{% if user_ratings.common_with_req_user.higher %}#}
{#				<div class="row">#}
{#					<p class="text-center lead">Titles you rated higher</p>#}
{#					{% for title in user_ratings.common_with_req_user.higher %}#}
{#						{% include 'titles/titles_in_a_row.html' with title=title owner=is_owner rate=title.user_rate req_user_rate=title.req_user_rate %}#}
{#					{% endfor %}#}
{#				</div>#}
{#				<hr>#}
{#				{% endif %}#}
{#				{% if user_ratings.common_with_req_user.lower %}#}
{#				<div class="row">#}
{#					<p class="text-center lead">Titles you rated lower</p>#}
{#					{% for title in user_ratings.common_with_req_user.lower %}#}
{#						{% include 'titles/titles_in_a_row.html' with title=title owner=is_owner rate=title.user_rate req_user_rate=title.req_user_rate %}#}
{#					{% endfor %}#}
{#				</div>#}
{#				<hr>#}
{#				{% endif %}#}
{#				<p class="text-center lead">Summary</p>#}
{#				You and {{ object.username }} rated {{ user_ratings.common_with_req_user.count }} the same titles<br>#}
{#				{% if user_ratings.common_with_req_user.req_user_rate_avg %}#}
{#					You rated them {{ user_ratings.common_with_req_user.req_user_rate_avg|floatformat:2 }} and {{ object.username }} rated them {{ user_ratings.common_with_req_user.user_rate_avg|floatformat:2 }}<br>#}
{#				{% endif %}#}
{#				You saw {{ user_ratings.common_with_req_user.percentage }}% of {{ object.username }}'s#}
{#				<a href="{{ object.ratings_url }}">{{ object.count_titles }} ratings</a><br>#}
{#				<a href="{% url 'title-list' %}?u={{ object.username }}&exclude_his=on">See titles</a> that only you have seen#}
{#			</div>#}
{#		</div>#}
{#	</div>#}
{#</div>#}
{#{% endif %}#}
{#{% if user_ratings.last_seen %}#}
{#<div class="row">#}
{#	<div class="col-md-10 col-md-offset-1">#}
{#		<div class="text-center">#}
{#			<div id="graph_btns" class="btn-group" role="group" aria-label="...">#}
{#				<button id="graph_genres" class="btn btn-default">genres</button>#}
{#				<button id="graph_months" class="btn btn-default">months</button>#}
{#				<button id="graph_rated" class="btn btn-default">rated</button>#}
{#				<button id="graph_year" class="btn btn-default">year</button>#}
{#			</div>#}
{#		</div>#}
{#		<div id="graph" style="margin-top: 3%"></div>#}
{#	</div>#}
{#</div>#}
{#{% endif %}#}
{##}
{#<div id="dialog-confirm" title="Clear all your ratings?" style="display:none;">#}
{#	<p><span class="ui-icon ui-icon-alert" style="float:left; margin:12px 12px 20px 0;"></span>You cannot revert this operation. You will lose all of you ratings if you haven't exported them first. As a confirmation - enter your username and press OK.</p>#}
{#	<input type="text" id="confirm-nickname">#}
{#</div>#}
{% endblock %}